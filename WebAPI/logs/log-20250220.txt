{"@t":"2025-02-20T05:33:46.7550919Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["28049.7710"],"@tr":"541758ea494c6f34d4631136b680f263","@sp":"4f09d180ba8c3c55","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":28049.771,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHE07UAOLH:00000001","ConnectionId":"0HNAHE07UAOLH"}
{"@t":"2025-02-20T05:39:56.5438152Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27810.5348"],"@tr":"fd2c334d516503d3fab4dde562705e80","@sp":"9aa5bf2ab33e22fb","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":27810.5348,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHE3GB5QLG:00000001","ConnectionId":"0HNAHE3GB5QLG"}
{"@t":"2025-02-20T05:44:50.6572625Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27736.4027"],"@tr":"ce5fe299215990fa04976fe176a4ddb0","@sp":"3d7c07ce9d88f39f","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":27736.4027,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHE6A8GGAV:00000001","ConnectionId":"0HNAHE6A8GGAV"}
{"@t":"2025-02-20T05:46:23.0361747Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["19401.2485"],"@tr":"924b1abb0dba2d033649154e9d42b53e","@sp":"e70f6ff2285fc235","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":400,"Elapsed":19401.2485,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHE6A8GGB1:00000001","ConnectionId":"0HNAHE6A8GGB1"}
{"@t":"2025-02-20T05:51:54.8199601Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27077.5162"],"@tr":"47f0fb0b56e569b37ba0fafbaf23ff12","@sp":"cf1dd3a8d1764ccd","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":27077.5162,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHEA9JGVAU:00000001","ConnectionId":"0HNAHEA9JGVAU"}
{"@t":"2025-02-20T06:08:27.5866260Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["9180.7869"],"@l":"Error","@x":"Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Purchase__E8A7AA55A2779E92'. Cannot insert duplicate key in object 'dbo.PurchaseOrderHeader'. The duplicate key value is (PO-GR55).\r\nThe statement has been terminated.\r\n   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)\r\n   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)\r\n   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)\r\n   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)\r\n   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)\r\n   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)\r\n   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)\r\n   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__210_1(IAsyncResult result)\r\n   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)\r\n--- End of stack trace from previous location ---\r\n   at Infrastructure.Data.PurchaseOrderRepository.BulkInsertUsingTVPAsync(List`1 headers, List`1 details) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Infrastructure\\Data\\PurchaseOrderRepository.cs:line 59\r\n   at BulkInsertPurchaseOrderTVPHandler.Handle(BulkInsertPurchaseOrderTVPCommand request, CancellationToken cancellationToken) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Application\\Handlers\\BulkInsertPurchaseOrderTVPHandler.cs:line 17\r\n   at PurchaseOrderController.UploadExcelFileUsingTVP(IFormFile file) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Presentation\\Controllers\\PurchaseOrderController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\nClientConnectionId:f3641188-d0b2-4af7-b833-60dd20024ed8\r\nError Number:2627,State:1,Class:14","@tr":"ea3ab96b6a13470df0fd355289c2921b","@sp":"d6b8e0c136ad635e","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":500,"Elapsed":9180.7869,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHEA9JGVB0:00000001","ConnectionId":"0HNAHEA9JGVB0"}
{"@t":"2025-02-20T06:08:27.7082225Z","@mt":"An unhandled exception has occurred while executing the request.","@l":"Error","@x":"Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Purchase__E8A7AA55A2779E92'. Cannot insert duplicate key in object 'dbo.PurchaseOrderHeader'. The duplicate key value is (PO-GR55).\r\nThe statement has been terminated.\r\n   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)\r\n   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)\r\n   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)\r\n   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)\r\n   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)\r\n   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)\r\n   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)\r\n   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__210_1(IAsyncResult result)\r\n   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)\r\n--- End of stack trace from previous location ---\r\n   at Infrastructure.Data.PurchaseOrderRepository.BulkInsertUsingTVPAsync(List`1 headers, List`1 details) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Infrastructure\\Data\\PurchaseOrderRepository.cs:line 59\r\n   at BulkInsertPurchaseOrderTVPHandler.Handle(BulkInsertPurchaseOrderTVPCommand request, CancellationToken cancellationToken) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Application\\Handlers\\BulkInsertPurchaseOrderTVPHandler.cs:line 17\r\n   at PurchaseOrderController.UploadExcelFileUsingTVP(IFormFile file) in C:\\Users\\sspri\\source\\repos\\CleanArchitecture\\Presentation\\Controllers\\PurchaseOrderController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)\r\nClientConnectionId:f3641188-d0b2-4af7-b833-60dd20024ed8\r\nError Number:2627,State:1,Class:14","@tr":"ea3ab96b6a13470df0fd355289c2921b","@sp":"d6b8e0c136ad635e","EventId":{"Id":1,"Name":"UnhandledException"},"SourceContext":"Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware","RequestId":"0HNAHEA9JGVB0:00000001","RequestPath":"/api/purchase-orders/upload-excel-tvp","ConnectionId":"0HNAHEA9JGVB0"}
{"@t":"2025-02-20T08:52:46.5063663Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["31949.0525"],"@tr":"dd82eab6495d6f81e386895fb703f17e","@sp":"8cf0640e7cbafea9","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":31949.0525,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHHFC6RIND:00000001","ConnectionId":"0HNAHHFC6RIND"}
{"@t":"2025-02-20T08:54:10.4839864Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["32918.3185"],"@tr":"858c1626bd55909d189d6280c2e00649","@sp":"7c7d15fac3f2d9cb","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":32918.3185,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHHG23KAD2:00000001","ConnectionId":"0HNAHHG23KAD2"}
{"@t":"2025-02-20T08:55:37.7176182Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27832.0887"],"@tr":"2821d11854437d81570b17d8f919d1b9","@sp":"c15d37638a890bc4","RequestMethod":"POST","RequestPath":"/api/purchase-orders/upload-excel-tvp","StatusCode":200,"Elapsed":27832.0887,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNAHHGTS0KFI:00000001","ConnectionId":"0HNAHHGTS0KFI"}
